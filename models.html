

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Growth Models &mdash; Curveball 0.2.12+18.g2933f0b documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Likelihood" href="likelihood.html" />
    <link rel="prev" title="Plots" href="plots.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Curveball
          

          
            
            <img src="_static/logo_200px.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.2.12+18.g2933f0b
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ioutils.html">I/O Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="plots.html">Plots</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Growth Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#models">Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#logistic-model">Logistic model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#richards-model">Richards model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#baranyi-roberts-model">Baranyi-Roberts model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logistic-models-with-lag-phase">Logistic models with lag phase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#model-hierarchy-and-the-likelihood-ratio-test">Model hierarchy and the likelihood ratio test</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameter-guessing">Parameter guessing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-selection">Model selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-curveball.models">Members</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="likelihood.html">Likelihood</a></li>
<li class="toctree-l1"><a class="reference internal" href="competitions.html">Competition Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="troubleshooting.html">Troubleshooting</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Curveball</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Growth Models</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/models.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="growth-models">
<h1>Growth Models<a class="headerlink" href="#growth-models" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="#module-curveball.models" title="curveball.models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">models</span></code></a> module contains functions for fitting and selecting growth models to growth curve data.</p>
<p>This module contains:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#curveball.models.fit_model" title="curveball.models.fit_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_model()</span></code></a> is the main function of the model; it fits growth models to growth curve data.</p></li>
<li><p><strong>Growth functions</strong> (<code class="docutils literal notranslate"><span class="pre">*_function</span></code>) are Python function in which the first argumet is time and the rest of the argument are model parameters. Time can be given an a <code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code>.</p></li>
<li><p><strong>Growth models</strong> (<code class="docutils literal notranslate"><span class="pre">*_model</span></code>) are <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.Model</span></code></a> objects from the <a class="reference external" href="http://lmfit.github.io/lmfit-py/">lmfit</a> package. These objects wrap the growth functions and are used to fit models to data with parameter constraints and some useful statistics and models selection methods.</p></li>
<li><p><strong>Parameter guessing functions</strong> (<code class="docutils literal notranslate"><span class="pre">guess_*</span></code>) are function that use the shape of a growth curve to guess growth parameters <strong>without</strong> fitting a model to the data, but rather through analytic properties of the growth functions.</p></li>
<li><p><strong>Hypothesis testing</strong> (<code class="docutils literal notranslate"><span class="pre">has_*</span></code>) are functions that perform a statistical test to decide if a property of one model can be significantly observed in the data.</p></li>
<li><p><strong>Outlier functions</strong> (<code class="docutils literal notranslate"><span class="pre">find_outliers*</span></code>) are functions for identification of outlier growth curve in high-throughput data sets.</p></li>
<li><p><strong>Indirect trait calculation</strong> (<code class="docutils literal notranslate"><span class="pre">find_*</span></code>) are functions for calculating growth parameters that are indirectly represented by the models.</p></li>
<li><p>and some other utilities.</p></li>
</ul>
<div class="section" id="models">
<h2>Models<a class="headerlink" href="#models" title="Permalink to this headline">¶</a></h2>
<p>Curveball uses the logistic model and its derivaties, the Richards model and the Baranyi-Roberts model:</p>
<div class="section" id="logistic-model">
<h3>Logistic model<a class="headerlink" href="#logistic-model" title="Permalink to this headline">¶</a></h3>
<p>Also known as the <a class="reference external" href="https://en.wikipedia.org/wiki/Logistic_function#In_ecology:_modeling_population_growth">Valhulst model</a>,
the logistic model includes three parameters and is the simplest and most commonly used population growth model.</p>
<p>The logistic model is defined by an ordinary differential equation (ODE) which also has a closed form solution:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}    \frac{dN}{dt} = r N \Big(1 - \frac{N}{K}\Big) \Rightarrow\\N(t) = \frac{K}{1 - \Big(1 - \frac{K}{N_0} \Big)e^{-r t}}\end{aligned}\end{align} \]</div>
<ul class="simple">
<li><p>N: population size</p></li>
<li><p><span class="math notranslate nohighlight">\(N_0\)</span>: initial population size</p></li>
<li><p>r: initial per capita growth rate</p></li>
<li><p>K: maximum population size</p></li>
</ul>
</div>
<div class="section" id="richards-model">
<h3>Richards model<a class="headerlink" href="#richards-model" title="Permalink to this headline">¶</a></h3>
<p>Also known as the <a class="reference external" href="http://en.wikipedia.org/wiki/Generalised_logistic_function">Generalised logistic model</a>,
Richards model <a class="reference internal" href="#richards1959" id="id1"><span>[Richards1959]</span></a> (or in its discrete time version, the <span class="math notranslate nohighlight">\(\theta\)</span>-logistic model <a class="reference internal" href="#gilpin1973" id="id2"><span>[Gilpin1973]</span></a>)
extends the logistic model by including the curvature parameter <span class="math notranslate nohighlight">\(\nu\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\frac{dN}{dt} = r N \Big( 1 - \Big(\frac{N}{K}\Big)^{\nu} \Big) \Rightarrow\\N(t) = \frac{K}{\Big[1 - \Big(1 - \Big(\frac{K}{N_0}\Big)^{\nu}\Big) e^{-r \nu t}\Big]^{1/\nu}}\end{aligned}\end{align} \]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(y_0\)</span>: initial population size</p></li>
<li><p>r: initial per capita growth rate</p></li>
<li><p>K: maximum population size</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu\)</span>: curvature of the logsitic term</p></li>
</ul>
<p>The logistic model is then a special case of the Richards model for <span class="math notranslate nohighlight">\(\nu=1\)</span>,
that is, <strong>the Logistic model is nested in the Richards model</strong>.</p>
<p>When <span class="math notranslate nohighlight">\(\nu&gt;1\)</span>, the effect of the logistic term <span class="math notranslate nohighlight">\((1-(\frac{N}{K})^{\nu})\)</span>
increases in comparison to the logistic model,
and the transition from fast growth to slow growth is faster.</p>
<p>When <span class="math notranslate nohighlight">\(0&lt;\nu&lt;1\)</span>, the effect of the logistic term <span class="math notranslate nohighlight">\((1-(\frac{N}{K})^{\nu})\)</span>
decreases in comparison to the logistic model,
and the transition from fast growth to slow growth is faster.</p>
</div>
<div class="section" id="baranyi-roberts-model">
<h3>Baranyi-Roberts model<a class="headerlink" href="#baranyi-roberts-model" title="Permalink to this headline">¶</a></h3>
<p>The Baranyi-Roberts model <a class="reference internal" href="#baranyi1994" id="id3"><span>[Baranyi1994]</span></a> extends Richards model by introducing a lag phase
in which the population growth is slower than expected while it is adjusting to a new environment.
This extension is done by introducing and adjustment function, <span class="math notranslate nohighlight">\(\alpha(t)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\alpha(t) = \frac{q_0}{q_0 + e^{-v t}}\]</div>
<p>where <span class="math notranslate nohighlight">\(q_0\)</span> is the initial ajdustment of the population and <span class="math notranslate nohighlight">\(v\)</span> is the adjustment rate.</p>
<p>The model is then described by the following ODE and exact solution:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}            \frac{dN}{dt} = r \alpha(t) N \Big( 1 - \Big(\frac{N}{K}\Big)^{\nu} \Big) \Rightarrow\\            N(t) = \frac{K}{\Big[1 - \Big(1 - \Big(\frac{K}{N_0}\Big)^{\nu}\Big) e^{-r \nu A(t)}\Big]^{1/\nu}}\\A(t) = \int_0^t{\alpha(s)ds} = \int_0^t{\frac{q_0}{q_0 + e^{-v s}} ds} =
t + \frac{1}{v} \log{\Big( \frac{e^{-v t} + q_0}{1 + q_0} \Big)}\end{aligned}\end{align} \]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(N_0\)</span>: initial population size</p></li>
<li><p>r: initial per capita growth rate</p></li>
<li><p>K: maximum population size</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu\)</span>: curvature of the logsitic term</p></li>
<li><p><span class="math notranslate nohighlight">\(q_0\)</span>: initial adjustment to current environment</p></li>
<li><p>v: adjustment rate</p></li>
</ul>
<p>Note that <span class="math notranslate nohighlight">\(A(t) - t \to  \lambda\)</span> as <span class="math notranslate nohighlight">\(t \to \infty\)</span>; this <span class="math notranslate nohighlight">\(\lambda\)</span> is called the <em>lag duration</em>.</p>
<p>Richards model is then a special case of the Baranyi-Roberts model for <span class="math notranslate nohighlight">\(1/v \to 0\)</span>,
that is, <strong>Richards model is nested in Baranyi-Roberts</strong>.
Therefore, <strong>Logistic is also nested in Baranyi-Roberts</strong> by <span class="math notranslate nohighlight">\(\nu=1, 1/v \to 0\)</span>.</p>
</div>
<div class="section" id="logistic-models-with-lag-phase">
<h3>Logistic models with lag phase<a class="headerlink" href="#logistic-models-with-lag-phase" title="Permalink to this headline">¶</a></h3>
<p>We define tow additional models: Baranyi-Roberts with <span class="math notranslate nohighlight">\(\nu=1\)</span> or a logistic model with lag phase,
and the same model with <span class="math notranslate nohighlight">\(v=r\)</span> <a class="reference internal" href="#baty2004" id="id4"><span>[Baty2004]</span></a>.
These models have five and four and parameters, respectively.</p>
</div>
</div>
<div class="section" id="model-hierarchy-and-the-likelihood-ratio-test">
<h2>Model hierarchy and the likelihood ratio test<a class="headerlink" href="#model-hierarchy-and-the-likelihood-ratio-test" title="Permalink to this headline">¶</a></h2>
<p>The nesting hierarchy between the models is given in Fig. 1.
This nesting is used for the Likelihood ratio test using the function <a class="reference internal" href="#curveball.models.lrtest" title="curveball.models.lrtest"><code class="xref py py-func docutils literal notranslate"><span class="pre">curveball.models.lrtest()</span></code></a>
in which the nested model (to which the arrows point) is the first argument <code class="docutils literal notranslate"><span class="pre">m0</span></code>,
and the nesting model (from which the arrow points) is the second argument <code class="docutils literal notranslate"><span class="pre">m1</span></code>.</p>
<div class="figure align-default" id="id26">
<img alt="_images/LRTest_map.png" src="_images/LRTest_map.png" />
<p class="caption"><span class="caption-number">Fig. 6 </span><span class="caption-text">Fig. 1 - Map of model nesting for the likelihood ratio test.</span><a class="headerlink" href="#id26" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="parameter-guessing">
<h2>Parameter guessing<a class="headerlink" href="#parameter-guessing" title="Permalink to this headline">¶</a></h2>
<p>Before fitting models to the data, Curveball attempts to guess the growth parameters from the shape of the curve. These guesses are used as initial parameters in the model fitting procedure.</p>
<p><code class="docutils literal notranslate"><span class="pre">y0</span></code> and <code class="docutils literal notranslate"><span class="pre">K</span></code> are guessed from the minimum and maximum of the growth curve, respectively.</p>
<p><code class="docutils literal notranslate"><span class="pre">r</span></code> and <code class="docutils literal notranslate"><span class="pre">nu</span></code> are guessed in <code class="xref py py-func docutils literal notranslate"><span class="pre">guess_r()</span></code> and <code class="xref py py-func docutils literal notranslate"><span class="pre">guess_nu()</span></code>, respectively, using formulas from <a class="reference internal" href="#richards1959" id="id5"><span>[Richards1959]</span></a>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}N_{max} = K (1 + \nu)^{-\frac{1}{\nu}} \Rightarrow\\\frac{dN}{dt}_{max} = r K \nu (1 + \nu)^{-\frac{1 + \nu}{\nu}}\end{aligned}\end{align} \]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\frac{dN}{dt}_{max}\)</span>: maximum population growth rate</p></li>
<li><p><span class="math notranslate nohighlight">\(N_{max}\)</span>: population size/density when the population growth rate (<span class="math notranslate nohighlight">\(\frac{dN}{dt}\)</span>) is maximum</p></li>
<li><p>r: initial per capita growth rate</p></li>
<li><p>K: maximum population size</p></li>
<li><p><span class="math notranslate nohighlight">\(\nu\)</span>: curvature of the logsitic term</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">q0</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code>, the lag phase parameters, are guessed by fitting a Baranyi-Roberts model with fixed
<code class="docutils literal notranslate"><span class="pre">y0</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">K</span></code>, and <code class="docutils literal notranslate"><span class="pre">nu</span></code> (based on guesses) to the data.</p>
</div>
<div class="section" id="model-selection">
<h2>Model selection<a class="headerlink" href="#model-selection" title="Permalink to this headline">¶</a></h2>
<p>Model selection is done by comparing the <a class="reference external" href="http://en.wikipedia.org/wiki/Bayesian_information_criterion">Bayesian Information Criteria (BIC)</a>
of all model fits and choosing the model fit with the <strong>lowest</strong> BIC value.
BIC is a common method to measure the quality of a model fit <a class="reference internal" href="#kaas1995" id="id6"><span>[Kaas1995]</span></a>,
balancing between model fit (distance from data) and complexity (number of parameters).
See <code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.model.ModelFit.bic()</span></code> for more information.</p>
<p>Curveball also calculates the <em>weighted BIC</em> each model fitted to the same data.
This can be interpreted as the weight of evidence for each model.</p>
</div>
<div class="section" id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">curveball</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;plate_templates/G-RG-R.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">curveball</span><span class="o">.</span><span class="n">ioutils</span><span class="o">.</span><span class="n">read_tecan_xlsx</span><span class="p">(</span><span class="s1">&#39;data/Tecan_280715.xlsx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="n">plate</span><span class="o">=</span><span class="n">plate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">models</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">curveball</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Strain</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">],</span> <span class="n">PLOT</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">PRINT</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-default" id="id27">
<img alt="_images/example_model_fitting.svg" src="_images/example_model_fitting.svg" /><p class="caption"><span class="caption-number">Fig. 7 </span><span class="caption-text">Fig. 2 - Model fitting and selection. The figure is the result of calling <code class="docutils literal notranslate"><span class="pre">fig.savefig()</span></code> on the result of the above example code.
Red error bars: mean and standard deviation of data; Green solid line: model fit; Blue dashed line: initial guess.</span><a class="headerlink" href="#id27" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="citation">
<dt class="label" id="richards1959"><span class="brackets">Richards1959</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id5">2</a>)</span></dt>
<dd><p>Richards, F. J., 1959. <a class="reference external" href="http://dx.doi.org/10.1093/jxb/10.2.290">A Flexible Growth Function for Empirical Use</a>. Journal of Experimental Botany</p>
</dd>
<dt class="label" id="baranyi1994"><span class="brackets"><a class="fn-backref" href="#id3">Baranyi1994</a></span></dt>
<dd><p>Baranyi, J., Roberts, T. A., 1994. <a class="reference external" href="www.ncbi.nlm.nih.gov/pubmed/7873331">A dynamic approach to predicting bacterial growth in food</a>. Int. J. Food Microbiol.</p>
</dd>
<dt class="label" id="kaas1995"><span class="brackets"><a class="fn-backref" href="#id6">Kaas1995</a></span></dt>
<dd><p>Kass, R., Raftery, A., 1995. <a class="reference external" href="http://www.tandfonline.com/doi/abs/10.1080/01621459.1995.10476572">Bayes Factors</a>. J. Am. Stat. Assoc.</p>
</dd>
<dt class="label" id="gilpin1973"><span class="brackets"><a class="fn-backref" href="#id2">Gilpin1973</a></span></dt>
<dd><p>Gilpin, M. E., Ayala, F. J., 1973. <a class="reference external" href="https://dx.doi.org/10.1073/pnas.70.12.3590">Global Models of Growth and Competition</a>. Proc. Nat. Acad. Sci. U S A.</p>
</dd>
<dt class="label" id="baty2004"><span class="brackets"><a class="fn-backref" href="#id4">Baty2004</a></span></dt>
<dd><p>Baty, Florent, and Marie-Laure Delignette-Muller. 2004. <a class="reference external" href="http://linkinghub.elsevier.com/retrieve/pii/S016816050300429X">Estimating the Bacterial Lag Time: Which Model, Which Precision?</a>. Intl. J. Food Microbiol.</p>
</dd>
</dl>
</div>
<div class="section" id="module-curveball.models">
<span id="members"></span><h2>Members<a class="headerlink" href="#module-curveball.models" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="curveball.models.bootstrap_params">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">bootstrap_params</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">model_result</em>, <em class="sig-param">nsamples</em>, <em class="sig-param">unit='Well'</em>, <em class="sig-param">fit_kws=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#bootstrap_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.bootstrap_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample model parameters by fitting the model to resampled data.</p>
<p>The data is bootstraped by drawing growth curves (sampling from the <cite>unit</cite> column in <cite>df</cite>) with replacement.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>the data to fit</p>
</dd>
<dt><strong>model_result</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>result of fitting a <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.Model</span></code></a> to data in <code class="docutils literal notranslate"><span class="pre">df</span></code></p>
</dd>
<dt><strong>nsamples</strong><span class="classifier">int</span></dt><dd><p>number of samples to draw</p>
</dd>
<dt><strong>unit</strong><span class="classifier">str, optional</span></dt><dd><p>the name of the column in <cite>df</cite> that identifies a resampling unit, defaults to <code class="docutils literal notranslate"><span class="pre">Well</span></code></p>
</dd>
<dt><strong>fit_kws</strong><span class="classifier">dict, optional</span></dt><dd><p>dict of kwargs for <cite>fit_model</cite></p>
</dd>
<dt><strong>Returns</strong></dt><dd></dd>
<dt><strong>——-</strong></dt><dd></dd>
<dt><strong>pandas.DataFrame</strong></dt><dd><p>data frame of samples; each row is a sample, each column is a parameter.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl>
<dt><strong>ValueError</strong><span class="classifier">if <cite>model_result</cite> isn’t an instance of <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a></span></dt><dd></dd>
<dt><strong>ValueError</strong><span class="classifier">if <cite>df</cite> is empty</span></dt><dd></dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.sample_params" title="curveball.models.sample_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample_params</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="curveball.models.calc_weights">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">calc_weights</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">PLOT=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#calc_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.calc_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate weights for the fittiing procedure based on the standard deviations at each time point.</p>
<p>If there is more than one replicate, use the standard deviations as weight.
Warn about NaN and infinite values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>data frame with <cite>Time</cite> and <cite>OD</cite> columns</p>
</dd>
<dt><strong>PLOT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, plot the weights by time</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>weights</strong><span class="classifier">np.ndarray</span></dt><dd><p>array of weights, calculated as the inverse of the standard deviations at each time point</p>
</dd>
<dt><strong>fig</strong><span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated figure.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.axes.Axes</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated axis.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.chisqprob">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">chisqprob</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#curveball.models.chisqprob" title="Permalink to this definition">¶</a></dt>
<dd><p>Survival function (1 - <cite>cdf</cite>) at x of the given RV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array_like</span></dt><dd><p>quantiles</p>
</dd>
<dt><strong>arg1, arg2, arg3,…</strong><span class="classifier">array_like</span></dt><dd><p>The shape parameter(s) for the distribution (see docstring of the
instance object for more information)</p>
</dd>
<dt><strong>loc</strong><span class="classifier">array_like, optional</span></dt><dd><p>location parameter (default=0)</p>
</dd>
<dt><strong>scale</strong><span class="classifier">array_like, optional</span></dt><dd><p>scale parameter (default=1)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>sf</strong><span class="classifier">array_like</span></dt><dd><p>Survival function evaluated at x</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.cooks_distance">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">cooks_distance</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">model_fit</em>, <em class="sig-param">use_weights=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#cooks_distance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.cooks_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates Cook’s distance of each well given a specific model fit.</p>
<p>Cook’s distance is an estimate of the influence of a data curve when performing model fitting; 
it is used to find wells (growth curve replicates) that are suspicious as outliers.
The higher the distance, the more suspicious the curve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>growth curve data, see <a class="reference internal" href="ioutils.html#module-curveball.ioutils" title="curveball.ioutils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">curveball.ioutils</span></code></a> for a detailed definition.</p>
</dd>
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>result of model fitting procedure</p>
</dd>
<dt><strong>use_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>should the function use standard deviation across replicates as weights for the fitting procedure, defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>dict</dt><dd><p>a dictionary of Cook’s distances: keys are wells (from the <cite>Well</cite> column in <cite>df</cite>), values are Cook’s distances.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Cook's_distance">Wikipedia</a></p>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_K_ci">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_K_ci</code><span class="sig-paren">(</span><em class="sig-param">param_samples</em>, <em class="sig-param">ci=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_K_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_K_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates a confidence interval for <code class="docutils literal notranslate"><span class="pre">K</span></code>, the maximum population density from the model fit.</p>
<p>The confidence interval of the doubling time is the lower and higher percentiles such that 
<cite>ci</cite> percent of the max densities are within the confidence interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>param_samples</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>parameter samples, generated using <a href="#id7"><span class="problematic" id="id8">:function:`sample_params`</span></a> or <a href="#id9"><span class="problematic" id="id10">:function:`bootstrap_params`</span></a></p>
</dd>
<dt><strong>ci</strong><span class="classifier">float, optional</span></dt><dd><p>the fraction of doubling times that should be within the calculated limits. 0 &lt; <cite>ci</cite> &lt;, defaults to 0.95.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>low, high</strong><span class="classifier">float</span></dt><dd><p>the lower and the higher boundaries of the confidence interval of the maximum population density.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_all_outliers">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_all_outliers</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">model_fit</em>, <em class="sig-param">deviations=2</em>, <em class="sig-param">max_outlier_fraction=0.1</em>, <em class="sig-param">use_weights=True</em>, <em class="sig-param">PLOT=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_all_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_all_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Iteratively find outlier wells in growth curve data.</p>
<p>At each iteration, calls <a class="reference internal" href="#curveball.models.find_outliers" title="curveball.models.find_outliers"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_outliers()</span></code></a>.
Iterations stop when no more outliers are found or when the fraction of wells defined as outliers
is above <cite>max_outlier_fraction</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>growth curve data, see <a class="reference internal" href="ioutils.html#module-curveball.ioutils" title="curveball.ioutils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">curveball.ioutils</span></code></a> for a detailed definition.</p>
</dd>
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>result of model fitting procedure</p>
</dd>
<dt><strong>deviations</strong><span class="classifier">float, optional</span></dt><dd><p>the number of standard deviations that defines an outlier, defaults to 2.</p>
</dd>
<dt><strong>max_outlier_fraction</strong><span class="classifier">float, optional</span></dt><dd><p>maximum fraction of wells to define as outliers, defaults to 0.1 = 10%.</p>
</dd>
<dt><strong>use_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>should the function use standard deviation across replicates as weights for the fitting procedure, defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.axes.Axes</span></dt><dd><p>an axes to plot into; if not provided, a new one is created.</p>
</dd>
<dt><strong>PLOT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the function will plot the Cook’s distances of the wells and the threshold.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>outliers</strong><span class="classifier">list</span></dt><dd><p>a list of lists: the list nested at index <em>i</em> contains the labels of the outlier wells found at iteration <em>i</em>.</p>
</dd>
<dt><strong>fig</strong><span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated figure.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.axes.Axes</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated axis.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_lag">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_lag</code><span class="sig-paren">(</span><em class="sig-param">model_fit</em>, <em class="sig-param">params=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_lag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_lag" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the lag duration from the model fit.</p>
<p>The function calculates the tangent line to the model curve at the point of maximum derivative (the inflection point). 
The time when this line intersects with <span class="math notranslate nohighlight">\(N_0\)</span> (the initial population size) 
is labeled <span class="math notranslate nohighlight">\(\lambda\)</span> and is called the lag duration time <a class="reference internal" href="#rfaebd76e3d7f-fig2-2" id="id11">[fig2.2]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>the result of a model fitting procedure</p>
</dd>
<dt><strong>params</strong><span class="classifier">lmfit.parameter.Parameters, optional</span></dt><dd><p>if provided, these parameters will override <cite>model_fit</cite>’s parameters</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lam</strong><span class="classifier">float</span></dt><dd><p>the lag phase duration in the units of the <cite>model_fit</cite> <code class="docutils literal notranslate"><span class="pre">Time</span></code> variable (usually hours).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.find_lag_ci" title="curveball.models.find_lag_ci"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_lag_ci</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#curveball.models.has_lag" title="curveball.models.has_lag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_lag</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="rfaebd76e3d7f-fig2-2"><span class="brackets"><a class="fn-backref" href="#id11">fig2.2</a></span></dt>
<dd><p>Fig. 2.2 pg. 19 in Baranyi, J., 2010. <a class="reference external" href="http://www2.sci.u-szeged.hu/fokozatok/PDF/Baranyi_Jozsef/Disszertacio.pdf">Modelling and parameter estimation of bacterial growth with distributed lag time.</a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_lag_ci">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_lag_ci</code><span class="sig-paren">(</span><em class="sig-param">model_fit</em>, <em class="sig-param">param_samples</em>, <em class="sig-param">ci=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_lag_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_lag_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates a confidence interval for the lag duration from the model fit.</p>
<p>The lag duration for each parameter sample is calculated.
The confidence interval of the lag is the lower and higher percentiles such that 
<cite>ci</cite> percent of the random lag durations are within the confidence interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>the result of a model fitting procedure</p>
</dd>
<dt><strong>param_samples</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>parameter samples, generated using <a href="#id13"><span class="problematic" id="id14">:function:`sample_params`</span></a> or <a href="#id15"><span class="problematic" id="id16">:function:`bootstrap_params`</span></a></p>
</dd>
<dt><strong>ci</strong><span class="classifier">float, optional</span></dt><dd><p>the fraction of lag durations that should be within the calculated limits. 0 &lt; <cite>ci</cite> &lt;, defaults to 0.95.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>low, high</strong><span class="classifier">float</span></dt><dd><p>the lower and the higher boundaries of the confidence interval of the lag phase duration in the units of the <cite>model_fit</cite> <code class="docutils literal notranslate"><span class="pre">Time</span></code> variable (usually hours).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.find_lag" title="curveball.models.find_lag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_lag</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#curveball.models.has_lag" title="curveball.models.has_lag"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_lag</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_max_growth">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_max_growth</code><span class="sig-paren">(</span><em class="sig-param">model_fit</em>, <em class="sig-param">params=None</em>, <em class="sig-param">after_lag=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_max_growth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_max_growth" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the maximum population and specific growth rates from the model fit.</p>
<p>The function calculates the maximum population growth rate <span class="math notranslate nohighlight">\(a=\max{\frac{dy}{dt}}\)</span> 
as the derivative of the model curve and calculates its maximum. 
It also calculates the maximum of the per capita growth rate <span class="math notranslate nohighlight">\(\mu = \max{\frac{dy}{y \cdot dt}}\)</span>.
The latter is more useful as a metric to compare different strains or treatments 
as it does not depend on the population size/density.</p>
<p>For example, in the logistic model the population growth rate is a quadratic function of <span class="math notranslate nohighlight">\(y\)</span> 
so the maximum is realized when the 2nd derivative is zero:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\frac{dy}{dt} = r y (1 - \frac{y}{K}) \Rightarrow\\\frac{d^2 y}{dt^2} = r - 2\frac{r}{K}y \Rightarrow\\\frac{d^2 y}{dt^2} = 0 \Rightarrow y = \frac{K}{2} \Rightarrow\\\max{\frac{dy}{dt}} = \frac{r K}{4}\end{aligned}\end{align} \]</div>
<p>In contrast, the per capita growth rate a linear function of <span class="math notranslate nohighlight">\(y\)</span> 
and so its maximum is realized when <span class="math notranslate nohighlight">\(y=y_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\frac{dy}{y \cdot dt} = r (1 - \frac{y}{K}) \Rightarrow\\\max{\frac{dy}{y \cdot dt}} = \frac{dy}{y \cdot dt}(y=y_0) = r (1 - \frac{y_0}{K})     \end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>the result of a model fitting procedure</p>
</dd>
<dt><strong>params</strong><span class="classifier">lmfit.parameter.Parameters, optional</span></dt><dd><p>if provided, these parameters will override <cite>model_fit</cite>’s parameters</p>
</dd>
<dt><strong>after_lag</strong><span class="classifier">bool</span></dt><dd><p>if true, only explore the time after the lag phase. Otherwise start at time zero. Defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>t1</strong><span class="classifier">float</span></dt><dd><p>the time when the maximum population growth rate is achieved in the units of the <cite>model_fit</cite> <code class="docutils literal notranslate"><span class="pre">Time</span></code> variable.</p>
</dd>
<dt><strong>y1</strong><span class="classifier">float</span></dt><dd><p>the population size or density (OD) for which the maximum population growth rate is achieved.</p>
</dd>
<dt><strong>a</strong><span class="classifier">float</span></dt><dd><p>the maximum population growth rate.</p>
</dd>
<dt><strong>t2</strong><span class="classifier">float</span></dt><dd><p>the time when the maximum per capita growth rate is achieved in the units of the <cite>model_fit</cite> <cite>Time</cite> variable.</p>
</dd>
<dt><strong>y2</strong><span class="classifier">float</span></dt><dd><p>the population size or density (OD) for which the maximum per capita growth rate is achieved.</p>
</dd>
<dt><strong>mu</strong><span class="classifier">float</span></dt><dd><p>the the maximum specific (per capita) growth rate.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.find_max_growth_ci" title="curveball.models.find_max_growth_ci"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_max_growth_ci</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_max_growth_ci">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_max_growth_ci</code><span class="sig-paren">(</span><em class="sig-param">model_fit</em>, <em class="sig-param">param_samples</em>, <em class="sig-param">after_lag=True</em>, <em class="sig-param">ci=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_max_growth_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_max_growth_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates a confidence interval for the maximum population/specific growth rates from the model fit.</p>
<p>The maximum population/specific growth rate for each parameter sample is calculated.
The confidence interval of the rate is the lower and higher percentiles such that 
<cite>ci</cite> percent of the random rates are within the confidence interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>the result of a model fitting procedure</p>
</dd>
<dt><strong>param_samples</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>parameter samples, generated using <a href="#id17"><span class="problematic" id="id18">:function:`sample_params`</span></a> or <a href="#id19"><span class="problematic" id="id20">:function:`bootstrap_params`</span></a></p>
</dd>
<dt><strong>after_lag</strong><span class="classifier">bool</span></dt><dd><p>if true, only explore the time after the lag phase. Otherwise start at time zero. Defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
<dt><strong>ci</strong><span class="classifier">float, optional</span></dt><dd><p>the fraction of lag durations that should be within the calculated limits. 0 &lt; <cite>ci</cite> &lt;, defaults to 0.95</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>low_a, high_a</strong><span class="classifier">float</span></dt><dd><p>the lower and the higher boundaries of the confidence interval of the the maximum population growth rate in the units of the <cite>model_fit</cite> <code class="docutils literal notranslate"><span class="pre">OD</span></code>/<code class="docutils literal notranslate"><span class="pre">Time</span></code> (usually OD/hours).</p>
</dd>
<dt><strong>low_mu, high_mu</strong><span class="classifier">float</span></dt><dd><p>the lower and the higher boundaries of the confidence interval of the the maximum specific growth rate in the units of the <cite>model_fit</cite> 1/<code class="docutils literal notranslate"><span class="pre">Time</span></code> variable (usually 1/hours).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.find_max_growth" title="curveball.models.find_max_growth"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_max_growth</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_min_doubling_time">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_min_doubling_time</code><span class="sig-paren">(</span><em class="sig-param">model_fit</em>, <em class="sig-param">params=None</em>, <em class="sig-param">PLOT=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_min_doubling_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_min_doubling_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the minimal doubling time from the model fit.</p>
<p>The function evaluates a growth curves based on the model fit and supplied parameters (if any) 
and calculates that time required to double the population density at each time point. 
It then returns the minimal doubling time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>the result of a model fitting procedure</p>
</dd>
<dt><strong>params</strong><span class="classifier">lmfit.parameter.Parameters, optional</span></dt><dd><p>if provided, these parameters will override <cite>model_fit</cite>’s parameters</p>
</dd>
<dt><strong>PLOT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the function will plot the Cook’s distances of the wells and the threshold. # FIXME</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>min_dbl</strong><span class="classifier">float</span></dt><dd><p>the minimal time it takes the population density to double.</p>
</dd>
<dt><strong>fig</strong><span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated figure.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.axes.Axes</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated axis.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_min_doubling_time_ci">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_min_doubling_time_ci</code><span class="sig-paren">(</span><em class="sig-param">model_fit</em>, <em class="sig-param">param_samples</em>, <em class="sig-param">ci=0.95</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_min_doubling_time_ci"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_min_doubling_time_ci" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates a confidence interval for the minimal doubling time from the model fit.</p>
<p>The minimal doubling time for each parameter sample is calculated.
The confidence interval of the doubling time is the lower and higher percentiles such that 
<cite>ci</cite> percent of the random lag durations are within the confidence interval.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>the result of a model fitting procedure</p>
</dd>
<dt><strong>param_samples</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>parameter samples, generated using <a href="#id21"><span class="problematic" id="id22">:function:`sample_params`</span></a> or <a href="#id23"><span class="problematic" id="id24">:function:`bootstrap_params`</span></a></p>
</dd>
<dt><strong>ci</strong><span class="classifier">float, optional</span></dt><dd><p>the fraction of doubling times that should be within the calculated limits. 0 &lt; <cite>ci</cite> &lt;, defaults to 0.95.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>low, high</strong><span class="classifier">float</span></dt><dd><p>the lower and the higher boundaries of the confidence interval of the minimal doubling times in the units of the <cite>model_fit</cite> <code class="docutils literal notranslate"><span class="pre">Time</span></code> variable (usually hours).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.find_min_doubling_time" title="curveball.models.find_min_doubling_time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_min_doubling_time</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="curveball.models.find_outliers">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">find_outliers</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">model_fit</em>, <em class="sig-param">deviations=2</em>, <em class="sig-param">use_weights=True</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">PLOT=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#find_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.find_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Find outlier wells in growth curve data.</p>
<p>Uses the Cook’s distance approach (<cite>cooks_distance</cite>); 
values of Cook’s distance that are <cite>deviations</cite> standard deviations <strong>above</strong> the mean
are defined as outliers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>growth curve data, see <a class="reference internal" href="ioutils.html#module-curveball.ioutils" title="curveball.ioutils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">curveball.ioutils</span></code></a> for a detailed definition.</p>
</dd>
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>result of model fitting procedure</p>
</dd>
<dt><strong>deviations</strong><span class="classifier">float, optional</span></dt><dd><p>the number of standard deviations that defines an outlier, defaults to 2.</p>
</dd>
<dt><strong>use_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>should the function use standard deviation across replicates as weights for the fitting procedure, defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.axes.Axes, optional</span></dt><dd><p>an axes to plot into; if not provided, a new one is created.</p>
</dd>
<dt><strong>PLOT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the function will plot the Cook’s distances of the wells and the threshold.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>outliers</strong><span class="classifier">list</span></dt><dd><p>the labels of the outlier wells.</p>
</dd>
<dt><strong>fig</strong><span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated figure.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.axes.Axes</span></dt><dd><p>if the argument <cite>PLOT</cite> was <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the generated axis.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.fit_exponential_growth_phase">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">fit_exponential_growth_phase</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">N</em>, <em class="sig-param">k=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#fit_exponential_growth_phase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.fit_exponential_growth_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits an exponential model to the exponential growth phase.</p>
<p>Fits a polynomial p(t)~N, finds tmax the time of the maximum of the derivative dp/dt,
and fits a linear function to log(N) around tmax.
The resulting slope (a) and intercept (b) are the parameters of the exponential model:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}N(t) = N_0 e^{at}\\N_0 = e^b\end{aligned}\end{align} \]</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>slope</strong><span class="classifier">float</span></dt><dd><p>slope of the linear regression, a</p>
</dd>
<dt><strong>intercept</strong><span class="classifier">float</span></dt><dd><p>intercept of the linear regression, b</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.fit_model">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">fit_model</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">param_guess=None</em>, <em class="sig-param">param_min=None</em>, <em class="sig-param">param_max=None</em>, <em class="sig-param">param_fix=None</em>, <em class="sig-param">models=None</em>, <em class="sig-param">use_weights=False</em>, <em class="sig-param">use_Dfun=False</em>, <em class="sig-param">method='leastsq'</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">PLOT=True</em>, <em class="sig-param">PRINT=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#fit_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.fit_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit and select a growth model to growth curve data.</p>
<p>This function fits several growth models to growth curve data (<code class="docutils literal notranslate"><span class="pre">OD</span></code> as a function of <code class="docutils literal notranslate"><span class="pre">Time</span></code>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>df</strong><span class="classifier">pandas.DataFrame</span></dt><dd><p>growth curve data, see <a class="reference internal" href="ioutils.html#module-curveball.ioutils" title="curveball.ioutils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">curveball.ioutils</span></code></a> for a detailed definition.</p>
</dd>
<dt><strong>param_guess</strong><span class="classifier">dict, optional</span></dt><dd><p>a dictionary of parameter guesses to use (key: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of param name; value: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> of param guess).</p>
</dd>
<dt><strong>param_min</strong><span class="classifier">dict, optional</span></dt><dd><p>a dictionary of parameter minimum bounds to use (key: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of param name; value: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> of param min bound).</p>
</dd>
<dt><strong>param_max</strong><span class="classifier">dict, optional</span></dt><dd><p>a dictionary of parameter maximum bounds to use (key: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> of param name; value: <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> of param max bound).</p>
</dd>
<dt><strong>param_fix</strong><span class="classifier">set, optional</span></dt><dd><p>a set of names (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) of parameters to fix rather then vary, while fitting the models.</p>
</dd>
<dt><strong>use_weights</strong><span class="classifier">bool, optional</span></dt><dd><p>should the function use the deviation across replicates as weights for the fitting procedure, defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>use_Dfun</strong><span class="classifier">bool, optional</span></dt><dd><p>should the function calculate the partial derivatives of the model functions to be used in the fitting procedure, defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
<dt><strong>models</strong><span class="classifier">one or more model classes, optional</span></dt><dd><p>model classes (not instances) to use for fitting; defaults to all model classes in <cite>curveball.baranyi_roberts_model</cite>.</p>
</dd>
<dt><strong>method</strong><span class="classifier">str, optional</span></dt><dd><p>the minimization method to use, defaults to <cite>leastsq</cite>, 
can be anything accepted by <code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.Minimizer.minimize()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">lmfit.minimizer.Minimizer.scalar_minimize()</span></code>.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.axes.Axes, optional</span></dt><dd><p>an axes to plot into; if not provided, a new one is created.</p>
</dd>
<dt><strong>PLOT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the function will plot the all model fitting results.</p>
</dd>
<dt><strong>PRINT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the function will print the all model fitting results.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>models</strong><span class="classifier">list of lmfit.model.ModelResult</span></dt><dd><p>all model fitting results, sorted by increasing BIC (a measure of fit quality).</p>
</dd>
<dt><strong>fig</strong><span class="classifier">matplotlib.figure.Figure</span></dt><dd><p>figure object.</p>
</dd>
<dt><strong>ax</strong><span class="classifier">numpy.ndarray</span></dt><dd><p>array of <a class="reference external" href="https://matplotlib.org/api/axes_api.html#matplotlib.axes.Axes" title="(in Matplotlib v3.1.0)"><code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code></a> objects, one for each model result, with the same order as <cite>models</cite>.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>TypeError</dt><dd><p>if one of the input parameters is of the wrong type (not guaranteed).</p>
</dd>
<dt>ValueError</dt><dd><p>if the input is bad, for example, <cite>df</cite> is empty (not guaranteed).</p>
</dd>
<dt>AssertionError</dt><dd><p>if any of the intermediate calculated values are inconsistent (for example, <code class="docutils literal notranslate"><span class="pre">y0&lt;0</span></code>).</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">curveball</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plate</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;plate_templates/G-RG-R.csv&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">curveball</span><span class="o">.</span><span class="n">ioutils</span><span class="o">.</span><span class="n">read_tecan_xlsx</span><span class="p">(</span><span class="s1">&#39;data/Tecan_280715.xlsx&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="n">plate</span><span class="o">=</span><span class="n">plate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">green_models</span> <span class="o">=</span> <span class="n">curveball</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">fit_model</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">Strain</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span><span class="p">],</span> <span class="n">PLOT</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="curveball.models.get_models">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">get_models</code><span class="sig-paren">(</span><em class="sig-param">module</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#get_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.get_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds and returns all models in <cite>module</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>module</strong><span class="classifier">module</span></dt><dd><p>the module in which to look for models</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>list</dt><dd><p>list of subclasses of <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.Model</span></code></a> that can be used with <a class="reference internal" href="#curveball.models.fit_model" title="curveball.models.fit_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">curveball.models.fit_model()</span></code></a></p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.fit_model" title="curveball.models.fit_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fit_model</span></code></a></dt><dd></dd>
<dt><a class="reference internal" href="#curveball.models.is_model" title="curveball.models.is_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_model</span></code></a></dt><dd></dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">curveball.baranyi_roberts_model</span></code></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="function">
<dt id="curveball.models.has_lag">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">has_lag</code><span class="sig-paren">(</span><em class="sig-param">model_fits</em>, <em class="sig-param">alfa=0.05</em>, <em class="sig-param">PRINT=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#has_lag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.has_lag" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if if the best fit has statisticaly significant lag phase <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span>.</p>
<p>If the best fitted model doesn’t has a lag phase to begin with, return <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>. 
This includes the logistic model and Richards model.</p>
<p>Otherwise, a likelihood ratio test will be perfomed with nesting determined according to Figure 1. 
The null hypothesis of the test is that <span class="math notranslate nohighlight">\(\frac{1}{v} = 0\)</span> , 
i.e. the adjustment rate <span class="math notranslate nohighlight">\(v\)</span> is infinite and therefore there is no lag phase.</p>
<p>The function will return <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> if the null hypothesis is rejected, 
otherwise it will return <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fits</strong><span class="classifier">sequence of lmfit.model.ModelResult</span></dt><dd><p>the results of several model fitting procedures, ordered by their statistical preference. Generated by <a class="reference internal" href="#curveball.models.fit_model" title="curveball.models.fit_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_model()</span></code></a>.</p>
</dd>
<dt><strong>alfa</strong><span class="classifier">float, optional</span></dt><dd><p>test significance level, defaults to 0.05 = 5%.</p>
</dd>
<dt><strong>PRINT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the function will print the result of the underlying statistical test; defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>the result of the hypothesis test. <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> if the null hypothesis was rejected and the data suggest that there is a significant lag phase.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>raised if the fittest of the <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a> objects in <cite>model_fits</cite> is of an unknown model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.has_nu">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">has_nu</code><span class="sig-paren">(</span><em class="sig-param">model_fits</em>, <em class="sig-param">alfa=0.05</em>, <em class="sig-param">PRINT=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#has_nu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.has_nu" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if if the best fit has <span class="math notranslate nohighlight">\(\nu \ne 1\)</span> and if so if that is statisticaly significant.</p>
<p>If the best fitted model has <span class="math notranslate nohighlight">\(\nu = 1\)</span> to begin with, return <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>. This includes the logistic model.
Otherwise, a likelihood ratio test will be perfomed with nesting determined according to Figure 1. 
The null hypothesis of the test is that <span class="math notranslate nohighlight">\(\nu = 1\)</span>; if it is rejected than the function will return <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>.
Otherwise it will return <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fits</strong><span class="classifier">list lmfit.model.ModelResult</span></dt><dd><p>the results of several model fitting procedures, ordered by their statistical preference. Generated by <a class="reference internal" href="#curveball.models.fit_model" title="curveball.models.fit_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_model()</span></code></a>.</p>
</dd>
<dt><strong>alfa</strong><span class="classifier">float, optional</span></dt><dd><p>test significance level, defaults to 0.05 = 5%.</p>
</dd>
<dt><strong>PRINT</strong><span class="classifier">bool, optional</span></dt><dd><p>if <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code>, the function will print the result of the underlying statistical test; defaults to <code class="xref py py-const docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd><p>the result of the hypothesis test. <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> if the null hypothesis was rejected and the data suggest that <span class="math notranslate nohighlight">\(\nu\)</span> is significantly different from one.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt>ValueError</dt><dd><p>raised if the fittest of the <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a> objects in <cite>model_fits</cite> is of an unknown model.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.information_criteria_weights">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">information_criteria_weights</code><span class="sig-paren">(</span><em class="sig-param">results</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#information_criteria_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.information_criteria_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate weighted AIC and BIC for model results.</p>
<p>where <span class="math notranslate nohighlight">\(w_i\)</span> is the weighted measure for model result <span class="math notranslate nohighlight">\(i\)</span> and
<span class="math notranslate nohighlight">\(x_i\)</span> is the AIC or BIC of model result <span class="math notranslate nohighlight">\(i\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>results</strong><span class="classifier">sequence of lmfit.model.ModelResult</span></dt><dd><p>use the <code class="xref py py-attr docutils literal notranslate"><span class="pre">lmfit.attr.ModelResult.aic</span></code> and <code class="xref py py-attr docutils literal notranslate"><span class="pre">lmfit.model.ModelResult.bic</span></code> attributes to add a <cite>weighted_aic</cite> and <cite>weighted_bic</cite> attribute.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><a class="reference external" href="http://stats.stackexchange.com/questions/35010/aic-bic-number-interpretation/44360#44360">Weighted AIC explained</a>.</p></li>
</ul>
</dd></dl>

<dl class="function">
<dt id="curveball.models.is_model">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">is_model</code><span class="sig-paren">(</span><em class="sig-param">cls</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#is_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.is_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="xref py py-const docutils literal notranslate"><span class="pre">True</span></code> if the input is a subclass of <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.Model" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.Model</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cls</strong><span class="classifier">class</span></dt><dd></dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>bool</dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="curveball.models.lrtest">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">lrtest</code><span class="sig-paren">(</span><em class="sig-param">m0</em>, <em class="sig-param">m1</em>, <em class="sig-param">alfa=0.05</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#lrtest"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.lrtest" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a likelihood ratio test on two nested models.</p>
<p>For two models, one nested in the other 
(meaning that the nested model estimated parameters are a subset of the nesting model), 
the test statistic <span class="math notranslate nohighlight">\(D\)</span> is:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\Lambda = \Big( \Big(\frac{\sum{(X_i - \hat{X_i}(\theta_1))^2}}{\sum{(X_i - \hat{X_i}(\theta_0))^2}}\Big)^{n/2} \Big)\\D = -2 log \Lambda\\lim_{n \to \infty} D \sim \chi^2_{df=\Delta}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(\Lambda\)</span> is the likelihood ratio, <span class="math notranslate nohighlight">\(D\)</span> is the statistic, 
<span class="math notranslate nohighlight">\(X_{i}\)</span> are the data points, <span class="math notranslate nohighlight">\(\hat{X_i}(\theta)\)</span> is the 
model prediction with parameters <span class="math notranslate nohighlight">\(\theta\)</span>, 
<span class="math notranslate nohighlight">\(\theta_i\)</span> is the parameters estimation for model <span class="math notranslate nohighlight">\(i\)</span>, 
<span class="math notranslate nohighlight">\(n\)</span> is the number of data points, and <span class="math notranslate nohighlight">\(\Delta\)</span> is the 
difference in number of parameters between the models.</p>
<p>The function compares between two <a class="reference external" href="https://lmfit.github.io/lmfit-py/model.html#lmfit.model.ModelResult" title="(in lmfit v0.9.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">lmfit.model.ModelResult</span></code></a> objects. 
These are the results of fitting models to the same dataset 
using the <a class="reference external" href="lmfit.github.io/lmfit-py">lmfit</a> package.</p>
<p>The function compares between model fit <cite>m0</cite> and <cite>m1</cite> and assumes that <cite>m0</cite> is nested in <cite>m1</cite>, 
meaning that the set of varying parameters of <cite>m0</cite> is a subset of the varying parameters of <cite>m1</cite>. 
<code class="xref py py-attr docutils literal notranslate"><span class="pre">lmfit.model.ModelResult.chisqr</span></code> is the sum of the square of the residuals of the fit. 
<code class="xref py py-attr docutils literal notranslate"><span class="pre">lmfit.model.ModelResult.ndata</span></code> is the number of data points. 
<code class="xref py py-attr docutils literal notranslate"><span class="pre">lmfit.model.ModelResult.nvarys</span></code> is the number of varying parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>m0, m1</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>objects representing two model fitting results. <cite>m0</cite> is assumed to be nested in <cite>m1</cite>.</p>
</dd>
<dt><strong>alfa</strong><span class="classifier">float, optional</span></dt><dd><p>test significance level, defaults to 0.05 = 5%.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>prefer_m1</strong><span class="classifier">bool</span></dt><dd><p>should we prefer <cite>m1</cite> over <cite>m0</cite></p>
</dd>
<dt><strong>pval</strong><span class="classifier">float</span></dt><dd><p>the test p-value</p>
</dd>
<dt><strong>D</strong><span class="classifier">float</span></dt><dd><p>the test statistic</p>
</dd>
<dt><strong>ddf</strong><span class="classifier">int</span></dt><dd><p>the number of degrees of freedom</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p><a class="reference external" href="http://www.stat.sc.edu/~habing/courses/703/GLRTExample.pdf">Generalised Likelihood Ratio Test Example</a>.</p></li>
<li><p><a class="reference external" href="http://nbviewer.ipython.org/github/yoavram/ipython-notebooks/blob/master/likelihood%20ratio%20test.ipynb">IPython notebook</a>.</p></li>
</ul>
</dd></dl>

<dl class="function">
<dt id="curveball.models.sample_params">
<code class="sig-prename descclassname">curveball.models.</code><code class="sig-name descname">sample_params</code><span class="sig-paren">(</span><em class="sig-param">model_fit</em>, <em class="sig-param">nsamples</em>, <em class="sig-param">params=None</em>, <em class="sig-param">covar=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/curveball/models.html#sample_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#curveball.models.sample_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Random sample of parameter values from a truncated multivariate normal distribution defined by the 
covariance matrix of the a model fitting result.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>model_fit</strong><span class="classifier">lmfit.model.ModelResult</span></dt><dd><p>the model fit that defines the sampled distribution</p>
</dd>
<dt><strong>nsamples</strong><span class="classifier">int</span></dt><dd><p>number of samples to make</p>
</dd>
<dt><strong>params</strong><span class="classifier">dict, optional</span></dt><dd><p>a dictionary of model parameter values; if given, overrides values from <cite>model_fit</cite></p>
</dd>
<dt><strong>covar</strong><span class="classifier">numpy.ndarray, optional</span></dt><dd><p>an array containing the parameters covariance matrix; if given, overrides values from <cite>model_fit</cite></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt>pandas.DataFrame</dt><dd><p>data frame of samples; each row is a sample, each column is a parameter.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="#curveball.models.bootstrap_params" title="curveball.models.bootstrap_params"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bootstrap_params</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="likelihood.html" class="btn btn-neutral float-right" title="Likelihood" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plots.html" class="btn btn-neutral float-left" title="Plots" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Yoav Ram
      <span class="lastupdated">
        Last updated on 17 Jun, 2019.
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>